<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark">
    <meta name="supported-color-schemes" content="light dark">

    <title>WinFsp API: launch.h &middot; WinFsp</title>

    <link rel="stylesheet" href="../../css/primer.css" />
    <link rel="stylesheet" href="../../css/site.css" />
  </head>
  <body class="bg-white text-gray-dark">
    <div id="container" class="container-lg clearfix">

      <div id="top" class="d-block d-md-none">
        <div class="clearfix bg-gray-light border-bottom p-3">
          <img src="../../logo.png" class="float-left mr-3 auto-invert" style="height:32px;" />
          <h1 class="f2-light text-uppercase float-left">WinFsp</h1>
          <details class="dropdown details-reset details-overlay float-right">
            <summary class="btn-octicon" aria-haspopup="true">
              <img src="../../svg/three-bars.svg" class="auto-invert" />
            </summary>
            <ul class="dropdown-menu dropdown-menu-w">
              <li><a class="dropdown-item" href="../../">Main</a></li><li><a class="dropdown-item" href="../../rel">Download</a></li><li><a class="dropdown-item" href="../../apiref">API Reference</a></li><li><a class="dropdown-item" href="../../doc">Documentation</a></li><li><a class="dropdown-item" href="../../src">Source</a></li>
            </ul>
          </details>
        </div>
      </div>

      <div id="side" class="col-md-3 float-left d-none d-md-block">
        <div class="p-3" style="min-height:100vh">
          <div class="mb-3 text-center">
              <img src="../../logo.png" class="auto-invert" style="width:75%;" />
            </div>
          <h1 class="f1-light text-uppercase text-center mb-3">WinFsp</h1>
          <nav class="SideNav border"><a class="SideNav-item" href="../../" >Main</a>
              <a class="SideNav-item" href="../../rel" >Download</a>
              <a class="SideNav-item" href="../../apiref" >API Reference</a>
              <a class="SideNav-item" href="../../doc" aria-current="page">Documentation</a>
              <nav class="SideNav py-2 pl-3">
                  <a class="SideNav-subItem" href="../../doc/Frequently-Asked-Questions/" >Frequently Asked Questions</a><a class="SideNav-subItem" href="../../doc/Known-File-Systems/" >Known File Systems</a><a class="SideNav-subItem" href="../../doc/Native-API-vs-FUSE/" >Native API vs FUSE</a><a class="SideNav-subItem" href="../../doc/NTFS-Compatibility/" >NTFS Compatibility</a><a class="SideNav-subItem" href="../../doc/Queued-Events/" >Queued Events</a><a class="SideNav-subItem" href="../../doc/SSHFS-Port-Case-Study/" >SSHFS Port Case Study</a><a class="SideNav-subItem" href="../../doc/WinFsp-API-launch.h/" aria-current="page">WinFsp API: launch.h</a><a class="SideNav-subItem" href="../../doc/WinFsp-API-winfsp.h/" >WinFsp API: winfsp.h</a><a class="SideNav-subItem" href="../../doc/WinFsp-as-an-IPC-Mechanism/" >WinFsp as an IPC Mechanism</a><a class="SideNav-subItem" href="../../doc/WinFsp-Debugging-Setup/" >WinFsp Debugging Setup</a><a class="SideNav-subItem" href="../../doc/WinFsp-Design/" >WinFsp Design</a><a class="SideNav-subItem" href="../../doc/WinFsp-Kernel-Mode-File-Systems/" >WinFsp Kernel Mode File Systems</a><a class="SideNav-subItem" href="../../doc/WinFsp-Performance-Testing/" >WinFsp Performance Testing</a><a class="SideNav-subItem" href="../../doc/WinFsp-Service-Architecture/" >WinFsp Service Architecture</a><a class="SideNav-subItem" href="../../doc/WinFsp-Testing/" >WinFsp Testing</a><a class="SideNav-subItem" href="../../doc/WinFsp-Tutorial/" >WinFsp Tutorial</a>
                </nav><a class="SideNav-item" href="../../src" >Source</a>
              
          </nav>
        </div>
      </div>

      <div id="main" class="col-12 col-md-9 float-left">
        <div class="p-3 markdown-body" style="min-height:100vh">
          
<h1 id="winfsplaunchh">winfsp/launch.h</h1>
<p>WinFsp Launch API.</p>
<p>In order to use the WinFsp Launch API a program must include &lt;winfsp/launch.h&gt;
and link with the winfsp_x64.dll (or winfsp_x86.dll) library.</p>
<h2 id="launch-control">LAUNCH CONTROL</h2>
<h3 id="functions">Functions</h3>
<details>
<summary>
<b>FspLaunchCallLauncherPipe</b> - Call launcher pipe.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">NTSTATUS</span> <span class="nf">FspLaunchCallLauncherPipe</span><span class="p">(</span> 
    <span class="n">WCHAR</span> <span class="n">Command</span><span class="p">,</span>
    <span class="n">ULONG</span> <span class="n">Argc</span><span class="p">,</span>
    <span class="n">PWSTR</span> <span class="o">*</span><span class="n">Argv</span><span class="p">,</span>
    <span class="n">ULONG</span> <span class="o">*</span><span class="n">Argl</span><span class="p">,</span> 
    <span class="n">PWSTR</span> <span class="n">Buffer</span><span class="p">,</span>
    <span class="n">PULONG</span> <span class="n">PSize</span><span class="p">,</span> 
    <span class="n">PULONG</span> <span class="n">PLauncherError</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>Command</em> - Launcher command to send. For example, the &lsquo;L&rsquo; launcher command instructs
the launcher to list all running service instances.</li>
<li><em>Argc</em> - Command argument count. May be 0.</li>
<li><em>Argv</em> - Command argument array. May be NULL.</li>
<li><em>Argl</em> - Command argument length array. May be NULL. If this is NULL all command arguments
are assumed to be NULL-terminated strings. It is also possible for specific arguments
to be NULL-terminated; in this case pass -1 in the corresponding Argl position.</li>
<li><em>Buffer</em> - Buffer that receives the command response. May be NULL.</li>
<li><em>PSize</em> - Pointer to a ULONG. On input it contains the size of the Buffer. On output it
contains the number of bytes transferred. May be NULL.</li>
<li><em>PLauncherError</em> - Receives the launcher error if any. This is always a Win32 error code. May not be NULL.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>STATUS_SUCCESS if the command is sent successfully to the launcher, even if the launcher
returns an error. Other status codes indicate a communication error. Launcher errors are
reported through PLauncherError.</p>
<p><strong>Discussion</strong></p>
<p>This function is used to send a command to the launcher and receive a response.</p>
</blockquote>
</details>
<details>
<summary>
<b>FspLaunchCallLauncherPipeEx</b> - Call launcher pipe.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">NTSTATUS</span> <span class="nf">FspLaunchCallLauncherPipeEx</span><span class="p">(</span> 
    <span class="n">WCHAR</span> <span class="n">Command</span><span class="p">,</span>
    <span class="n">ULONG</span> <span class="n">Argc</span><span class="p">,</span>
    <span class="n">PWSTR</span> <span class="o">*</span><span class="n">Argv</span><span class="p">,</span>
    <span class="n">ULONG</span> <span class="o">*</span><span class="n">Argl</span><span class="p">,</span> 
    <span class="n">PWSTR</span> <span class="n">Buffer</span><span class="p">,</span>
    <span class="n">PULONG</span> <span class="n">PSize</span><span class="p">,</span> 
    <span class="n">BOOLEAN</span> <span class="n">AllowImpersonation</span><span class="p">,</span> 
    <span class="n">PULONG</span> <span class="n">PLauncherError</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>Command</em> - Launcher command to send. For example, the &lsquo;L&rsquo; launcher command instructs
the launcher to list all running service instances.</li>
<li><em>Argc</em> - Command argument count. May be 0.</li>
<li><em>Argv</em> - Command argument array. May be NULL.</li>
<li><em>Argl</em> - Command argument length array. May be NULL. If this is NULL all command arguments
are assumed to be NULL-terminated strings. It is also possible for specific arguments
to be NULL-terminated; in this case pass -1 in the corresponding Argl position.</li>
<li><em>Buffer</em> - Buffer that receives the command response. May be NULL.</li>
<li><em>PSize</em> - Pointer to a ULONG. On input it contains the size of the Buffer. On output it
contains the number of bytes transferred. May be NULL.</li>
<li><em>AllowImpersonation</em> - Allow caller to be impersonated by launcher.</li>
<li><em>PLauncherError</em> - Receives the launcher error if any. This is always a Win32 error code. May not be NULL.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>STATUS_SUCCESS if the command is sent successfully to the launcher, even if the launcher
returns an error. Other status codes indicate a communication error. Launcher errors are
reported through PLauncherError.</p>
<p><strong>Discussion</strong></p>
<p>This function is used to send a command to the launcher and receive a response.</p>
</blockquote>
</details>
<details>
<summary>
<b>FspLaunchGetInfo</b> - Get information about a service instance.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">NTSTATUS</span> <span class="nf">FspLaunchGetInfo</span><span class="p">(</span> 
    <span class="n">PWSTR</span> <span class="n">ClassName</span><span class="p">,</span>
    <span class="n">PWSTR</span> <span class="n">InstanceName</span><span class="p">,</span> 
    <span class="n">PWSTR</span> <span class="n">Buffer</span><span class="p">,</span>
    <span class="n">PULONG</span> <span class="n">PSize</span><span class="p">,</span> 
    <span class="n">PULONG</span> <span class="n">PLauncherError</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>ClassName</em> - Class name of the service instance to stop.</li>
<li><em>InstanceName</em> - Instance name of the service instance to stop.</li>
<li><em>Buffer</em> - Buffer that receives the command response. May be NULL.</li>
<li><em>PSize</em> - Pointer to a ULONG. On input it contains the size of the Buffer. On output it
contains the number of bytes transferred. May be NULL.</li>
<li><em>PLauncherError</em> - Receives the launcher error if any. This is always a Win32 error code. May not be NULL.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>STATUS_SUCCESS if the command is sent successfully to the launcher, even if the launcher
returns an error. Other status codes indicate a communication error. Launcher errors are
reported through PLauncherError.</p>
<p><strong>Discussion</strong></p>
<p>The information is a list of NULL-terminated strings: the class name of the service instance,
the instance name of the service instance and the full command line used to start the service
instance.</p>
</blockquote>
</details>
<details>
<summary>
<b>FspLaunchGetNameList</b> - List service instances.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">NTSTATUS</span> <span class="nf">FspLaunchGetNameList</span><span class="p">(</span> 
    <span class="n">PWSTR</span> <span class="n">Buffer</span><span class="p">,</span>
    <span class="n">PULONG</span> <span class="n">PSize</span><span class="p">,</span> 
    <span class="n">PULONG</span> <span class="n">PLauncherError</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>Buffer</em> - Buffer that receives the command response. May be NULL.</li>
<li><em>PSize</em> - Pointer to a ULONG. On input it contains the size of the Buffer. On output it
contains the number of bytes transferred. May be NULL.</li>
<li><em>PLauncherError</em> - Receives the launcher error if any. This is always a Win32 error code. May not be NULL.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>STATUS_SUCCESS if the command is sent successfully to the launcher, even if the launcher
returns an error. Other status codes indicate a communication error. Launcher errors are
reported through PLauncherError.</p>
<p><strong>Discussion</strong></p>
<p>The information is a list of pairs of NULL-terminated strings. Each pair contains the class
name and instance name of a service instance. All currently running service instances are
listed.</p>
</blockquote>
</details>
<details>
<summary>
<b>FspLaunchStart</b> - Start a service instance.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">NTSTATUS</span> <span class="nf">FspLaunchStart</span><span class="p">(</span> 
    <span class="n">PWSTR</span> <span class="n">ClassName</span><span class="p">,</span>
    <span class="n">PWSTR</span> <span class="n">InstanceName</span><span class="p">,</span>
    <span class="n">ULONG</span> <span class="n">Argc</span><span class="p">,</span>
    <span class="n">PWSTR</span> <span class="o">*</span><span class="n">Argv</span><span class="p">,</span> 
    <span class="n">BOOLEAN</span> <span class="n">HasSecret</span><span class="p">,</span> 
    <span class="n">PULONG</span> <span class="n">PLauncherError</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>ClassName</em> - Class name of the service instance to start.</li>
<li><em>InstanceName</em> - Instance name of the service instance to start.</li>
<li><em>Argc</em> - Service instance argument count. May be 0.</li>
<li><em>Argv</em> - Service instance argument array. May be NULL.</li>
<li><em>HasSecret</em> - Whether the last argument in Argv is assumed to be a secret (e.g. password) or not.
Secrets are passed to service instances through standard input rather than the command
line.</li>
<li><em>PLauncherError</em> - Receives the launcher error if any. This is always a Win32 error code. May not be NULL.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>STATUS_SUCCESS if the command is sent successfully to the launcher, even if the launcher
returns an error. Other status codes indicate a communication error. Launcher errors are
reported through PLauncherError.</p>
</blockquote>
</details>
<details>
<summary>
<b>FspLaunchStartEx</b> - Start a service instance.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">NTSTATUS</span> <span class="nf">FspLaunchStartEx</span><span class="p">(</span> 
    <span class="n">PWSTR</span> <span class="n">ClassName</span><span class="p">,</span>
    <span class="n">PWSTR</span> <span class="n">InstanceName</span><span class="p">,</span>
    <span class="n">ULONG</span> <span class="n">Argc</span><span class="p">,</span>
    <span class="n">PWSTR</span> <span class="o">*</span><span class="n">Argv</span><span class="p">,</span> 
    <span class="n">BOOLEAN</span> <span class="n">HasSecret</span><span class="p">,</span> 
    <span class="n">BOOLEAN</span> <span class="n">AllowImpersonation</span><span class="p">,</span> 
    <span class="n">PULONG</span> <span class="n">PLauncherError</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>ClassName</em> - Class name of the service instance to start.</li>
<li><em>InstanceName</em> - Instance name of the service instance to start.</li>
<li><em>Argc</em> - Service instance argument count. May be 0.</li>
<li><em>Argv</em> - Service instance argument array. May be NULL.</li>
<li><em>HasSecret</em> - Whether the last argument in Argv is assumed to be a secret (e.g. password) or not.
Secrets are passed to service instances through standard input rather than the command
line.</li>
<li><em>AllowImpersonation</em> - Allow caller to be impersonated by launcher.</li>
<li><em>PLauncherError</em> - Receives the launcher error if any. This is always a Win32 error code. May not be NULL.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>STATUS_SUCCESS if the command is sent successfully to the launcher, even if the launcher
returns an error. Other status codes indicate a communication error. Launcher errors are
reported through PLauncherError.</p>
</blockquote>
</details>
<details>
<summary>
<b>FspLaunchStop</b> - Stop a service instance.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">NTSTATUS</span> <span class="nf">FspLaunchStop</span><span class="p">(</span> 
    <span class="n">PWSTR</span> <span class="n">ClassName</span><span class="p">,</span>
    <span class="n">PWSTR</span> <span class="n">InstanceName</span><span class="p">,</span> 
    <span class="n">PULONG</span> <span class="n">PLauncherError</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>ClassName</em> - Class name of the service instance to stop.</li>
<li><em>InstanceName</em> - Instance name of the service instance to stop.</li>
<li><em>PLauncherError</em> - Receives the launcher error if any. This is always a Win32 error code. May not be NULL.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>STATUS_SUCCESS if the command is sent successfully to the launcher, even if the launcher
returns an error. Other status codes indicate a communication error. Launcher errors are
reported through PLauncherError.</p>
</blockquote>
</details>
<h2 id="service-registry">SERVICE REGISTRY</h2>
<h3 id="functions-1">Functions</h3>
<details>
<summary>
<b>FspLaunchRegFreeRecord</b> - Free a service registry record.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">VOID</span> <span class="nf">FspLaunchRegFreeRecord</span><span class="p">(</span> 
    <span class="n">FSP_LAUNCH_REG_RECORD</span> <span class="o">*</span><span class="n">Record</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>Record</em> - The service record to free.</li>
</ul>
<p><strong>See Also</strong></p>
<ul>
<li>FspLaunchRegGetRecord</li>
</ul>
</blockquote>
</details>
<details>
<summary>
<b>FspLaunchRegGetRecord</b> - Get a service registry record.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">NTSTATUS</span> <span class="nf">FspLaunchRegGetRecord</span><span class="p">(</span> 
    <span class="n">PWSTR</span> <span class="n">ClassName</span><span class="p">,</span>
    <span class="n">PWSTR</span> <span class="n">Agent</span><span class="p">,</span> 
    <span class="n">FSP_LAUNCH_REG_RECORD</span> <span class="o">**</span><span class="n">PRecord</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>ClassName</em> - The service class name.</li>
<li><em>Agent</em> - The name of the agent that is retrieving the service record. This API matches
the supplied Agent against the Agent in the service record and it only returns
the record if they match. Pass NULL to match any Agent.</li>
<li><em>PRecord</em> - Pointer to a record pointer. Memory for the service record will be allocated
and a pointer to it will be stored at this address. This memory must be later
freed using FspLaunchRegFreeRecord.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>STATUS_SUCCESS or error code.</p>
<p><strong>See Also</strong></p>
<ul>
<li>FspLaunchRegFreeRecord</li>
</ul>
</blockquote>
</details>
<details>
<summary>
<b>FspLaunchRegSetRecord</b> - Add/change/delete a service registry record.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">FSP_API</span> <span class="n">NTSTATUS</span> <span class="nf">FspLaunchRegSetRecord</span><span class="p">(</span> 
    <span class="n">PWSTR</span> <span class="n">ClassName</span><span class="p">,</span> 
    <span class="k">const</span> <span class="n">FSP_LAUNCH_REG_RECORD</span> <span class="o">*</span><span class="n">Record</span><span class="p">);</span>  
</code></pre></div><p><strong>Parameters</strong></p>
<ul>
<li><em>ClassName</em> - The service class name.</li>
<li><em>Record</em> - The record to set in the registry. If NULL, the registry record is deleted.</li>
</ul>
<p><strong>Return Value</strong></p>
<p>STATUS_SUCCESS or error code.</p>
</blockquote>
</details>
<h3 id="typedefs">Typedefs</h3>
<details>
<summary>
<b>FSP_LAUNCH_REG_RECORD</b> - Service registry record.
</summary>
<blockquote>
<br/>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">_FSP_LAUNCH_REG_RECORD</span> <span class="p">{</span> 
    <span class="n">PWSTR</span> <span class="n">Agent</span><span class="p">;</span> 
    <span class="n">PWSTR</span> <span class="n">Executable</span><span class="p">;</span> 
    <span class="n">PWSTR</span> <span class="n">CommandLine</span><span class="p">;</span> 
    <span class="n">PWSTR</span> <span class="n">WorkDirectory</span><span class="p">;</span> 
    <span class="n">PWSTR</span> <span class="n">RunAs</span><span class="p">;</span> 
    <span class="n">PWSTR</span> <span class="n">Security</span><span class="p">;</span> 
    <span class="n">PWSTR</span> <span class="n">AuthPackage</span><span class="p">;</span> 
    <span class="n">PVOID</span> <span class="n">Reserved0</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span> 
    <span class="n">ULONG</span> <span class="n">JobControl</span><span class="p">;</span> 
    <span class="n">ULONG</span> <span class="n">Credentials</span><span class="p">;</span> 
    <span class="n">ULONG</span> <span class="n">AuthPackageId</span><span class="p">;</span> 
    <span class="n">ULONG</span> <span class="n">Reserved1</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span> 
    <span class="n">UINT8</span> <span class="n">Buffer</span><span class="p">[];</span> 
<span class="p">}</span> <span class="n">FSP_LAUNCH_REG_RECORD</span><span class="p">;</span>  
</code></pre></div></blockquote>
</details>
<br/>
<p align="center">
<sub>
Copyright © 2015-2020 Bill Zissimopoulos
<br/>
Generated with <a href="https://github.com/billziss-gh/prettydoc">prettydoc</a>
</sub>
</p>

</div>
      </div>

    </div>
  </body>
</html>
